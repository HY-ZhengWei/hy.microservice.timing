<?xml version="1.0" encoding="UTF-8"?>

<config>

    <import name="sqls"            class="java.util.ArrayList" />
    <import name="sql"             class="org.hy.common.xml.XSQL" />



    <!-- 2024-01-16升级版本的自动化脚本的相关SQL -->
    <sqls>
    
        <sql id="XSQL_Upgrade_20240116_Step001">
        
            <dataSourceGroup ref="DSG_MS_Timing" />
            
            <content>
                <![CDATA[
                INSERT INTO TUpgrade20240116 (id ,createTime) VALUES ('任务责任人的逻辑删除' ,NOW());/
                
                ALTER TABLE TJobUser ADD    isDel INT NULL COMMENT '删除标记。1删除；0未删除';/
                
                UPDATE TJobUser SET isDel = 0;/
                
                ALTER TABLE TJobUser MODIFY isDel INT NOT NULL COMMENT '删除标记。1删除；0未删除';/
                
                UPDATE TUpgrade20240116 SET updateTime = NOW() WHERE id = '任务责任人的逻辑删除';/
                ]]>
            </content>
            
            <comment>操作日志添加：任务责任人的逻辑删除</comment>
            
        </sql>
        
        
    
        <sql id="XSQL_Create_Upgrade_20240116">
        
            <dataSourceGroup ref="DSG_MS_Timing" />
            
            <content>
                <![CDATA[
                CREATE TABLE TUpgrade20240116
                (
                 id                         VARCHAR(64)   NOT NULL COMMENT '主键'
                ,createTime                 DATETIME      NOT NULL COMMENT '创建时间'
                ,updateTime                 DATETIME               COMMENT '修改时间'
                ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;/
                
                ALTER TABLE TUpgrade20240116 ADD CONSTRAINT PK_TUpgrade20240116 PRIMARY KEY (id);/
                
                Alter TABLE TUpgrade20240116 COMMENT = '2024-01-16升级版本';/
                ]]>
            </content>
            
            <trigger>
                <create ref="XSQL_Upgrade_20240116_Step001" />
            </trigger>
            
            <comment>2024-01-16升级版本</comment>
            <create if="启用 == IsCreateDB_MS_Common.getValue">TUpgrade20240116</create>
            
        </sql>
        
    </sqls>
    
</config>